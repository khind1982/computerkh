#!/usr/bin/env python
# -*- mode: python -*-

# A wrapper around the eima_pagemap stuff.

import sys

from eima_pagemap import *
from eimabits import *


def main(product, resizelist, sourcedata):
    print >> sys.stderr, "populatethreading..."
    populatethreading(product, sourcedata)
    a = pagemapgenerator(product)
    print >> sys.stderr, "getresizefactors..."
    a.getresizefactors(resizelist)
    print >> sys.stderr, "gatherdata..."
    a.gatherdata(sourcedata)
    #print >> sys.stderr, "createhandoverdirs..."
    #a.createhandoverdirs(outputdir)
    #print >> sys.stderr, "createPCMIfiles..."
    #a.createPCMIfiles()
    #print >> sys.stderr, "createpagemapfiles..."
    #a.createpagemapfiles()
    print >> sys.stderr, "populate_pagethreading..."
    a.populate_pagethreading()
    print >> sys.stderr, "populate_hithighlighting_threading..."
    a.populate_hithighlighting_threading()
    print >> sys.stderr, "DONE!"

if __name__ == '__main__':
    if len(sys.argv) < 4:
        print >> sys.stderr, "Required arguments missing"
        print >> sys.stderr, "product resizelist sourcedata"
        exit(1)

    product = sys.argv[1]
    resizelist = sys.argv[2]
    sourcedata = sys.argv[3]
    #outputdir = sys.argv[4]

    main(product, resizelist, sourcedata)
